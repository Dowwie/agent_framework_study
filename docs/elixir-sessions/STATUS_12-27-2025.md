
  Completed Decisions

  1. Core Architecture: Deep Agents via GenServer + Task
  2. Process Structure: SessionController GenServer, Task.async for steps
  3. State Model: PostgreSQL + Redis with Ecto embedded schemas
  4. Message Protocol: Lightweight reference structs
  5. ETS Layout: 5 tables (:sessions, :messages, :context, :cache, :sub_agent_contexts)
  6. Clustering: Node affinity + ex_hash_ring + write-behind
  7. Tool System: Ecto schemas with introspection
  8. LLM Integration: Req + Behaviours, Hammer rate limiting, :fuse circuit breaker
  9. Memory/Context: Token budget + eviction, pgvector + pg_bm25
  10. Multi-Agent: Hub-and-spoke via SessionController
  11. Observability: Telemetry + OpenTelemetry
  12. Error Handling: Feed errors to LLM, checkpoint recovery
  13. Interrupts/Breakpoints: Hybrid step-level + runtime
  14. Human-in-the-Loop: Step type + tool, PubSub â†’ WebSocket
  15. Time Travel: Hybrid snapshots + events
  16. Sub-Agent Architecture: Task-based with ETS context
  17. Artifact Storage: S3-compatible with behaviour abstraction
  18. System Prompts: EEx templates with override
  19. Context Handoff: Hybrid code + LLM extraction

  Open Refinement Areas (from critique document)

  There's a recent critique document (docs/enhancing_elixir_spec.md) identifying six areas for potential refinement:

  | #   | Area                      | Concern                                                |
  |-----|---------------------------|--------------------------------------------------------|
  | 1   | Concurrency & Determinism | BSP superstep modeling for Time Travel consistency     |
  | 2   | Hierarchical Memory       | Adopt 50/30/20 compression (recent/summary/semantic)   |
  | 3   | Tool Sandboxing           | WASM/Docker for code execution (critical security gap) |
  | 4   | Resilience                | Standardize error-as-data pattern                      |
  | 5   | Type Safety               | Tagged structs for SessionID/StepID                    |
  | 6   | Observability             | Standardize on Agno 17-event taxonomy                  |

  ---

